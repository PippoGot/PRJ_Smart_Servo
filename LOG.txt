02/05/2025

ISSUE 001 (SOLVED): PWM CONTROL SIGNAL FREQUENCY

Voltage accross the motor won't vary too much (how much?).
The control signal of the H-bridge has frequency of 300kHz.

SOLUTION:

A lower PWM frequency is tested. 
- 10kHz works, but produces high pitch noise.
- 20kHz works and has no noise audible. This is the solution accepted.


ISSUE 002 (TO VERIFY): CURRENT SENSOR CALIBRATION

For sensor calibration:
- the motor is replaced with a (47ohm 10%) resistor.
- a voltage staircase signal is imposed.
- sensor data is collected, along with multimeter data.
- the mean value for each step is computed.
- measured resistance is computed with both datasets, then compared to the nominal value of the dummy component.
- multimeter data returns an average resistance of 44.8571ohm (0.5954 variance), well inside tolerance boundaries.
- sensor data returns an average resistance of 58.8294ohm (3.9547 variance), extremely far from tolerance boundaries.

SOLUTION PROPOSED:

Calibrate each sensor independently based on data readings:
- calibrate the sensor as per datasheet instruction for first reading.
- replace the motor with a known low tolerance resistor (50ohm 1%) or (parallel of two 100ohm 1%).
- impose a staircase signal and acquire data.
- compute measured resistance and check with known value.
- if computed resistance is not in tolerance intervals compute new calibration value.
- repeat from point 3 until good values are obtained.
- sensor is calibrated.

This procedure can be automated.


ISSUE 003 (TO VERIFY): ACTUATOR INPUT-OUTPUT CHARACTERISTIC

When measuring voltage data with multimeter an inconsistence between input and output of the discrete component
H-bridge is noticed.
the relationship between input duty cycle and output voltage is not linear.

SOLUTION PROPOSED:

Replace the discrete component H-bridge with a more suited motor driver IC (DRV8830).


ISSUE 004 (TO EXPLORE): CURRENT SENSOR DIFFERENCES

The two different current sensors have a different amount of noise in the measurements. Find out why.


IDEA 001 (TO EXPLORE): POSITION AND SPEED DIY ENCODER

For low speed sensing, a 2 or 4 quadrature linear hall effect sensor (AH49E) circuit can be implemented.
The voltage of the sensors can be acquired directly via microcontroller for position estimation.
The voltage can be derivated physically with appropriate opamp circuittry and then acquired for speed estimation.

This would complete the state observation.


IDEA 002 (TO EXPLORE): SYSTEM IDENTIFICATION VALIDATION

Acquire data for system identification from 
- lab multimeter;
- clean simulation;
- noisy simulation;

for comparison and validation of identification algorithms.


TODO:

Design the complete PCB with new modifications, order it and test:
- sensor calibration;
- motor voltage;
- sensor readings;
- hall sensors readings;

Then, if sensor readings are correct, re-estimate the system parameters and update the model.
Try both old estimation technique and SINDy algorithm for system identification.


08/05/2025


LOG:

Modular models needed are built, automatic script simulation is implemented.
Estimation algorithm are also implemented and tested. Results match perfectly for all motor models with no noise.

IDEA 003 (TO EXPLORE): FULL PARAMETERS ESTIMATION

For full automatic system identification, estimation procedure for La and Ra can be designed.

With no movement (i.e. low voltage) read current and motor voltage at steady state, then estimate Ra.
With current PID control, impose a triangle current signal, then estimate La.
With current PID control, impose a triangle current signal, then estimate Ra and La using linear regression.


TODO:

Test SINDy algorithms for system identification.

Understand hybrid control (switching PID controller).


13/05/2025

LOG:

Tested some algorithms for parameters estimation in different situations.

Algorithm with best performances (both with and without noise, i.e. real components models):

- Simulate system. Triangle velocity reference with PID controller;
- Acquire data;
- Filter data with lowpass filter. wc = 2pi20, delta = 1/sqrt(2);
- Reshape data and trim transient;
- Least Square filtering: 
	- divide data in periods;
	- fit a line for each period;
	- calculate mean offset and coefficient;
	- reconstruct signal (single period);
- Least Square Derivation:
	- after filtering use the coefficient fo calculate derivative;
	- construct derivative approximation;
- Least Square estimation of parameters using the reconstructed signals;

Algorithm performs well for all parameters except motor inductance (La) which seems to be estimated 
correctly only with perfect measurement.

